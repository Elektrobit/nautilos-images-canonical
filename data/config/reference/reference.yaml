# SPDX-License-Identifier: GPL-2.0-or-later
---
preferences:
  type:
    _attributes:
      image: "oem"
      filesystem: "xfs"
      initrd_system: "dracut"
      overlayroot: "true"
      overlayroot_write_partition: "true"
      overlayroot_readonly_partsize: "1024"
      squashfscompression: "zstd"
      bootpartition: "true"
      bootfilesystem: "ext4"
      format: "qcow2"
      verity_blocks: "all"
      embed_verity_metadata: "true"
      luks_version: "luks2"
      luks: "insecure"
      kernelcmdline: "console=ttyS0 rd.systemd.verity=1 root=overlay:MAPPER=verityRoot verityroot=/dev/disk/by-partlabel/p.lxreadonly rd.root.overlay.write=/dev/mapper/luks rd.luks=yes rootwait pstore.backend=efi"
    partitions:
      partition:
        - _attributes:
            name: "home"
            size: "10"
            mountpoint: "/home"
            filesystem: "ext4"
        - _attributes:
            name: "oci-storage"
            size: "512"
            mountpoint: "/var/lib/containers/storage"
            filesystem: "xfs"
        - _attributes:
            name: "oci-preload"
            size: "512"
            mountpoint: "/var/lib/containers/loaded"
            filesystem: "squashfs"
    luksformat:
      option:
        - _attributes:
            name: "--cipher"
            value: "aegis128-random"
        - _attributes:
            name: "--key-size"
            value: "128"
        - _attributes:
            name: "--integrity"
            value: "aead"
        - _attributes:
            name: "--pbkdf"
            value: "argon2id"
        # The following values were chosen to optimise for low memory conditionsF
        - _attributes:
            name: "--pbkdf-memory"
            value: "178155"
        - _attributes:
            name: "--pbkdf-force-iterations"
            value: "4"
        - _attributes:
            name: "--pbkdf-parallel"
            value: "2"
    size:
      _attributes:
        unit: "G"
      _text: "3"
